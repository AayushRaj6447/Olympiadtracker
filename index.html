<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Olympiad Tracking</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .container { display: flex; gap: 20px; }
    .left, .right { flex: 1; }
    .buttons { margin: 10px 0; }
    button { padding: 6px 12px; margin: 3px; }
    .subject, .book, .section { display: inline-block; padding: 6px 10px; margin: 2px; border: 1px solid #888; cursor: pointer; }
    .selected { background-color: #4CAF50; color: white; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 4px; text-align: center; }
    h3 { margin-top: 20px; }
</style>
</head>
<body>

<h2>Olympiad Tracking System</h2>

<div>
    <label>Class: 
        <select id="classSelect">
            <option value="">Select</option>
            <script>
                for(let i=1;i<=10;i++){document.write(`<option value="${i}">${i}</option>`);}
            </script>
        </select>
    </label>
    <label>Roll No: <input type="number" id="rollNumber" min="1" max="250"></label>
</div>

<div>
    <h3>Section</h3>
    <div id="sectionList"></div>
</div>

<div>
    <h3>Exams (â‚¹150 each)</h3>
    <div id="examList"></div>
</div>

<div>
    <h3>Books</h3>
    <div id="bookList"></div>
</div>

<div class="buttons">
    <button onclick="prevStudent()">Previous</button>
    <button onclick="nextStudent()">Next</button>
</div>

<div>
    <button onclick="saveData()">Save</button>
</div>

<div>
    <h3>Live Summary</h3>
    <div id="summary"></div>
</div>

<script>
const exams = ["GK","English","Science","Maths","Computer","Social Studies","Hindi","Reasoning"];
const books = ["GK","English","Science","Maths","Computer","Social Studies","Hindi","Reasoning"];
const sections = ["A","B","C","D","E"];
let data = JSON.parse(localStorage.getItem("olympiadData") || "{}");
let currentStudent = 1;

function init() {
    const examList = document.getElementById("examList");
    const bookList = document.getElementById("bookList");
    const sectionList = document.getElementById("sectionList");

    exams.forEach((subj, i) => {
        let div = document.createElement("div");
        div.className = "subject";
        div.textContent = `${i+1}. ${subj}`;
        div.onclick = () => toggleSelection(div, "exam", i);
        examList.appendChild(div);
    });

    books.forEach((subj, i) => {
        let div = document.createElement("div");
        div.className = "book";
        div.textContent = `${String.fromCharCode(81+i)}. ${subj}`;
        div.onclick = () => toggleSelection(div, "book", i);
        bookList.appendChild(div);
    });

    sections.forEach((sec, i) => {
        let div = document.createElement("div");
        div.className = "section";
        div.textContent = sec;
        div.onclick = () => selectSection(div, sec);
        sectionList.appendChild(div);
    });

    document.addEventListener("keydown", handleKey);
    updateUI();
    updateSummary();
}

function toggleSelection(el, type, index) {
    el.classList.toggle("selected");
    saveSelection(type, index, el.classList.contains("selected"));
}

function selectSection(el, sec) {
    document.querySelectorAll(".section").forEach(e => e.classList.remove("selected"));
    el.classList.add("selected");
    saveSection(sec);
}

function handleKey(e) {
    let num = parseInt(e.key);
    if(num >= 1 && num <= 8) {
        document.querySelectorAll(".subject")[num-1].click();
    }
    let char = e.key.toUpperCase().charCodeAt(0);
    if(char >= 81 && char <= 79+8) {
        document.querySelectorAll(".book")[char-81].click();
    }
    if(e.key === "ArrowRight") nextStudent();
    if(e.key === "ArrowLeft") prevStudent();
}

function saveSelection(type, index, selected) {
    let cls = document.getElementById("classSelect").value;
    if(!cls) return;
    let roll = document.getElementById("rollNumber").value;
    if(!roll) return;
    if(!data[cls]) data[cls] = {};
    if(!data[cls][roll]) data[cls][roll] = {exams:[], books:[], section:null};

    if(type === "exam") {
        if(selected) data[cls][roll].exams.push(index);
        else data[cls][roll].exams = data[cls][roll].exams.filter(i => i !== index);
    } else if(type === "book") {
        if(selected) data[cls][roll].books.push(index);
        else data[cls][roll].books = data[cls][roll].books.filter(i => i !== index);
    }
    localStorage.setItem("olympiadData", JSON.stringify(data));
    updateSummary();
}

function saveSection(sec) {
    let cls = document.getElementById("classSelect").value;
    let roll = document.getElementById("rollNumber").value;
    if(!cls || !roll) return;
    if(!data[cls]) data[cls] = {};
    if(!data[cls][roll]) data[cls][roll] = {exams:[], books:[], section:null};
    data[cls][roll].section = sec;
    localStorage.setItem("olympiadData", JSON.stringify(data));
}

function saveData() {
    localStorage.setItem("olympiadData", JSON.stringify(data));
    alert("Data saved!");
}

function updateUI() {
    document.querySelectorAll(".subject, .book, .section").forEach(el => el.classList.remove("selected"));
    let cls = document.getElementById("classSelect").value;
    let roll = document.getElementById("rollNumber").value;
    if(cls && roll && data[cls] && data[cls][roll]) {
        data[cls][roll].exams.forEach(i => document.querySelectorAll(".subject")[i].classList.add("selected"));
        data[cls][roll].books.forEach(i => document.querySelectorAll(".book")[i].classList.add("selected"));
        if(data[cls][roll].section) {
            document.querySelectorAll(".section").forEach(secEl => {
                if(secEl.textContent === data[cls][roll].section) secEl.classList.add("selected");
            });
        }
    }
}

function nextStudent() {
    let roll = parseInt(document.getElementById("rollNumber").value) || 1;
    if(roll < 250) {
        document.getElementById("rollNumber").value = roll + 1;
        updateUI();
    }
}

function prevStudent() {
    let roll = parseInt(document.getElementById("rollNumber").value) || 1;
    if(roll > 1) {
        document.getElementById("rollNumber").value = roll - 1;
        updateUI();
    }
}

function updateSummary() {
    let summaryHTML = "<table><tr><th>Class</th><th>Section</th><th>Subject</th><th>Count</th><th>Total Fee</th></tr>";
    for(let cls in data) {
        let subjectCount = {};
        let totalFee = 0;
        for(let roll in data[cls]) {
            let student = data[cls][roll];
            totalFee += student.exams.length * 150;
            student.exams.forEach(i => {
                let subj = exams[i];
                if(!subjectCount[subj]) subjectCount[subj] = 0;
                subjectCount[subj]++;
            });
        }
        for(let subj in subjectCount) {
            summaryHTML += `<tr><td>${cls}</td><td>-</td><td>${subj}</td><td>${subjectCount[subj]}</td><td>${totalFee}</td></tr>`;
        }
    }
    summaryHTML += "</table>";
    document.getElementById("summary").innerHTML = summaryHTML;
}

document.getElementById("classSelect").addEventListener("change", updateUI);
document.getElementById("rollNumber").addEventListener("input", updateUI);
init();
</script>

</body>
</html>