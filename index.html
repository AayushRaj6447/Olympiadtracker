<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Olympiad Exam & Book Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    button { margin: 4px; padding: 8px; cursor: pointer; }
    .highlight { background-color: #90ee90; }
    table, th, td { border: 1px solid black; border-collapse: collapse; padding: 4px; }
    .group { margin-top: 10px; }
    #studentId { font-weight: bold; margin-left: 10px; }
  </style>
</head>
<body>
  <h2>Olympiad Tracker</h2>
  <div>
    <label>Class:
      <select id="classSelect">
        <option value="1">Class 1</option>
        <option value="2">Class 2</option>
        <option value="3">Class 3</option>
        <option value="4">Class 4</option>
        <option value="5">Class 5</option>
        <option value="6">Class 6</option>
        <option value="7">Class 7</option>
        <option value="8">Class 8</option>
        <option value="9">Class 9</option>
        <option value="10">Class 10</option>
      </select>
    </label>
    <button onclick="prevStudent()">Previous</button>
    <button onclick="nextStudent()">Next</button>
    <span id="studentId"></span>
  </div>

  <div class="group">
    <h3>Subjects</h3>
    <div id="buttons"></div>
  </div>

  <div class="group">
    <button onclick="resetStudent()">Reset This Student</button>
  </div>

  <h3>Summary</h3>
  <div id="summary"></div>

  <script>
    const subjects = ['GK','English','Science','Maths','Computer','Social Studies','Hindi','Reasoning'];
    const prices = { book: 100, reasoning: 250, exam: 150 };
    const maxStudents = 250;

    let currentClass = 1;
    let currentStudent = 1;
    let data = JSON.parse(localStorage.getItem("tracker") || "{}");

    const roman = ['I','II','III','IV','V','VI','VII','VIII','IX','X'];

    function studentKey() {
      return roman[currentClass - 1] + '_' + currentStudent;
    }

    function updateDisplay() {
      document.getElementById("studentId").innerText = "ID: " + studentKey();
      renderButtons();
      renderSummary();
    }

    function renderButtons() {
      const container = document.getElementById("buttons");
      const entry = data[studentKey()] || { exams: [], books: [] };
      container.innerHTML = "";
      subjects.forEach(sub => {
        const examBtn = document.createElement("button");
        examBtn.textContent = `âœ” Exam: ${sub}`;
        examBtn.className = entry.exams.includes(sub) ? "highlight" : "";
        examBtn.onclick = () => toggle(sub, "exams");

        const bookBtn = document.createElement("button");
        bookBtn.textContent = `ðŸ“˜ Book: ${sub}`;
        bookBtn.className = entry.books.includes(sub) ? "highlight" : "";
        bookBtn.onclick = () => toggle(sub, "books");

        container.appendChild(examBtn);
        container.appendChild(bookBtn);
      });
    }

    function toggle(subject, type) {
      const key = studentKey();
      if (!data[key]) data[key] = { class: currentClass, exams: [], books: [] };
      const arr = data[key][type];
      const idx = arr.indexOf(subject);
      if (idx >= 0) arr.splice(idx, 1);
      else arr.push(subject);
      saveData();
      updateDisplay();
    }

    function prevStudent() {
      if (currentStudent > 1) currentStudent--;
      updateDisplay();
    }

    function nextStudent() {
      if (currentStudent < maxStudents) currentStudent++;
      updateDisplay();
    }

    function resetStudent() {
      delete data[studentKey()];
      saveData();
      updateDisplay();
    }

    function saveData() {
      localStorage.setItem("tracker", JSON.stringify(data));
    }

    function renderSummary() {
      const summary = {};
      for (let cls = 1; cls <= 10; cls++) {
        summary[cls] = { exam: {}, book: {}, totalExam: 0, totalBook: 0 };
        subjects.forEach(s => { summary[cls].exam[s] = 0; summary[cls].book[s] = 0; });
      }

      Object.entries(data).forEach(([id, entry]) => {
        const cls = entry.class;
        entry.exams.forEach(s => {
          summary[cls].exam[s]++;
          summary[cls].totalExam += prices.exam;
        });
        entry.books.forEach(s => {
          summary[cls].book[s]++;
          summary[cls].totalBook += (s === "Reasoning" ? prices.reasoning : prices.book);
        });
      });

      let html = '<table><tr><th>Class</th>';
      subjects.forEach(s => html += `<th>${s} Exam</th><th>${s} Book</th>`);
      html += '<th>Exam â‚¹</th><th>Book â‚¹</th><th>Total â‚¹</th></tr>';

      for (let cls = 1; cls <= 10; cls++) {
        html += `<tr><td>${cls}</td>`;
        subjects.forEach(s => {
          html += `<td>${summary[cls].exam[s]}</td><td>${summary[cls].book[s]}</td>`;
        });
        const e = summary[cls].totalExam, b = summary[cls].totalBook;
        html += `<td>${e}</td><td>${b}</td><td>${e + b}</td></tr>`;
      }

      html += '</table>';
      document.getElementById("summary").innerHTML = html;
    }

    document.getElementById("classSelect").addEventListener("change", e => {
      currentClass = parseInt(e.target.value);
      currentStudent = 1;
      updateDisplay();
    });

    updateDisplay();
  </script>
</body>
</html>